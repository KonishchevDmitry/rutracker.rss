#!/usr/bin/env python

"""Suggests torrents to ignore."""

import pycl.main
pycl.main.set_environment()

import sys

from pycl.cli.text_table import TextTable
from pycl.misc import to_unicode

import rutracker.torrents


def main():
    """The script's main function."""

    if len(sys.argv) != 1:
        sys.exit(u"Invalid argument: {arg}\nUsage: {command}".format(
            arg = to_unicode(sys.argv[1]), command = to_unicode(sys.argv[0])))

    torrents = rutracker.torrents.get_stats(blacklist = True)[:25]

    if torrents:
        table = TextTable()
        for torrent in torrents:
            table.add_row({
                "count": torrent["count"],
                "group": torrent["fingerprint"],
                "name":  torrent["name"],
            })
        table.draw([
            { "id": "count",  "name": "Count", "align": "right" },
            { "id": "group",  "name": "Group", "align": "left"  },
            { "id": "name",   "name": "Name",  "align": "left", "max_width": 80 },
        ])
    else:
        print "There is nothing to suggest."


if __name__ == "__main__":
    main()
